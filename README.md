# WB ML Tryout Task

## Зависимости

Ожидается, что в системе установлен Python 3, а также:

```bash
pip install pandas implicit
```

Если планируется использовать *nmslib_als* или *annoy_als* модели, то еще `pip install nmslib annoy`

## Запуск

```bash
go run . --input=data --output=recommendations.csv
```

Список возможных аргументов:

* **--view** вес при создании модели для действия *success_view* от 0 до 10 (`1`)
* **--like** вес при создании модели для действия *like* от 0 до 10 (`3`)
* **--favorite** вес при создании модели для действия *favorite* от 0 до 10 (`10`)
* **--input** путь к папке с gzip-архивами датафреймов (`"data"`)
* **--rec_input** путь к папке с gzip-архивами датафреймов для рекомендаций. Если не задан, то генерации для рекомендаций используется тот же набор данных, что для обучения
* **--output** путь к результирующему файлу в формате "user_id video_id1 ... video_id300", 300 рекомендаций, разделитель пробел (`"recommendations.csv"`)
* **--python** путь к интерпретатору Python3 (`"python"`)
* **--model** модель для обучения: *als | nmslib_als | annoy_als | faiss_als | tfidf | cosine | bpr | lmf | bm25* (`"als"`)
* **--gpu** использовать при обучении GPU. Работает не на всех моделях, рекомендуется только на *als* и *faiss_als*. На *bpr* в текущей версии Implicit вызывает ошибку! (`false`)
* **--limit** ограничить число генерируемых рекомендаций числом
* **--evaluate** следует ли провести проверку модели и вывести результаты (*precision, map, ndcg, auc*) перед генераций рекомендаций. Для некоторых алгоритмов довольно работает очень медленно (`false`)

### Запуск скрипта напрямую

Когда датасеты с весами уже созданы, удобнее запускать скрипт рекомендаций напрямую

```bash
python recommend.py --input=train_data.tsv --rec_input=rec_data.tsv --output=recommendations.csv --gpu
```

Так доступен доп. аргумент: **--rec_count** принимает кол-во рекомендаций для генерации (`300`).

Остальной набор аргументов аналогичный, но *--input и --rec_input* принимают готовые взвешенные датасеты в виде одного файла,
нет весовых аргументов (*--view, --like, --favorite*).
